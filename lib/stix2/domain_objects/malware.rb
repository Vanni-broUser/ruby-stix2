module Stix2
  module DomainObject
    class Malware < Base
      property :name, coerce: String
      property :description, coerce: String
      property :malware_types, coerce: ->(v){ validate_array(v, Stix2::MALWARE_TYPE_OV) }
      property :is_family, coerce: ->(v){ is_boolean?(v) }
      property :aliases, coerce: Array[String]
      property :kill_chain_phases, coerce: Array[KillChainPhase]
      property :first_seen, coerce: Time
      property :last_seen, coerce: Time
      property :operating_system_refs, coerce: Array[Identifier]
      property :architecture_execution_envs, coerce: ->(v){ validate_array(v, Stix2::PROCESSOR_ARCHITECTURE_OV) }
      property :implementation_languages, coerce: ->(v){ validate_array(v, Stix2::IMPLEMENTATION_LANGUAGE_OV) }
      property :capabilities, coerce: ->(v){ validate_array(v, Stix2::IMPLEMENTATION_CAPABILITIES_OV) }
      property :sample_refs, coerce: Array[Identifier]
    end
  end
end
